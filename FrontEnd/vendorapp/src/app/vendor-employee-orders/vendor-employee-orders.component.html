<div class="col-md-12">
    <div class="card">
        <div class="card-header card-header-danger" *ngIf="globalFlag">
            <!-- <h4 class="card-title ">Orders</h4>
            <p class="card-category"> Order Details</p> -->
            <div style="float:right;">

                <button type="button" class="btn btn-outline-primary" data-toggle="modal" data-target="#customer11">Accept </button>&nbsp;
                <button type="button" class="btn btn-outline-primary" (click)="updateMultipleOrderStatus(orderNumber,'return')">Send Back </button>
            </div>
        </div>
        <div class="card-body">
            <ng-container>
                <div class="mat-elevation-z8 ">
                    <div class="table-specification">
                        <table mat-table [dataSource]="dataSource" matSort class="table-responsive">
                            <!-- <ng-container matColumnDef="id">
                                <th mat-header-cell *matHeaderCellDef> ID &nbsp;&nbsp;&nbsp;&nbsp;</th>
                                <td mat-cell *matCellDef="let element;let i=index"><a href="#" data-toggle="modal" data-target="#register" (click)="getdata(element)">{{element.ID}}</a>&nbsp;&nbsp;&nbsp;&nbsp;</td>
                            </ng-container> -->
                            <ng-container matColumnDef="select">
                                <th mat-header-cell *matHeaderCellDef>
                                    <mat-checkbox (change)="$event ? masterToggle() : null" [checked]="selection.hasValue() && isAllSelected()" [indeterminate]="selection.hasValue() && !isAllSelected()" [aria-label]="checkboxLabel()">
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</mat-checkbox>
                                </th>
                                <td mat-cell *matCellDef="let element">
                                    <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? selection.toggle(element) : null ; selectionData()" [checked]="selection.isSelected(element)" [aria-label]="checkboxLabel(element)">
                                  &nbsp;&nbsp;&nbsp;&nbsp;</mat-checkbox>
                                </td>
                            </ng-container>
                            <ng-container matColumnDef="orderNumber">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>Order Number&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
                                <td mat-cell *matCellDef="let element;let i=index"><a href="#" data-toggle="modal" data-target="#register" (click)="getdata(element)">{{element.orderNumber}}</a>&nbsp;&nbsp;&nbsp;&nbsp;
                                </td>
                                <!-- <td mat-cell *matCellDef="let element"> {{element.orderNumber}}&nbsp;&nbsp;&nbsp;&nbsp;</td> -->
                            </ng-container>
                            <ng-container matColumnDef="PO_Date">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header> PO Date&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
                                <td mat-cell *matCellDef="let element"> {{element.PO_Date}}&nbsp;&nbsp;&nbsp;&nbsp;</td>
                            </ng-container>
                            <ng-container matColumnDef="PO_Number">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header> PO Number&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
                                <td mat-cell *matCellDef="let element"> {{element.PO_Number}}&nbsp;&nbsp;&nbsp;&nbsp;
                                </td>
                            </ng-container>
                            <ng-container matColumnDef="orderAmount">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>Order Amount&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
                                <td mat-cell *matCellDef="let element"> {{element.orderAmount}}&nbsp;&nbsp;&nbsp;&nbsp;
                                </td>
                            </ng-container>
                            <ng-container matColumnDef="orderDate">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>Order Date&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
                                <td mat-cell *matCellDef="let element"> {{element.orderDate}}&nbsp;&nbsp;&nbsp;&nbsp;
                                </td>
                            </ng-container>
                            <ng-container matColumnDef="orderHandler">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>Order Handler&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
                                <td mat-cell *matCellDef="let element"> {{element.orderHandler}}&nbsp;&nbsp;&nbsp;&nbsp;
                                </td>
                            </ng-container>

                            <ng-container matColumnDef="owner">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>Owner&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
                                <td mat-cell *matCellDef="let element"> {{element.owner}}&nbsp;&nbsp;&nbsp;&nbsp;</td>
                            </ng-container>
                            <ng-container matColumnDef="globalStatus">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header>Order Status&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
                                <td mat-cell *matCellDef="let element">
                                    {{element.globalStatus}}&nbsp;&nbsp;&nbsp;&nbsp;</td>
                            </ng-container>
                            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                        </table>
                    </div>
                    <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
                </div>
            </ng-container>
        </div>


        <div class="modal fade" id="register" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-xl">
                <div class="modal-content">
                    <!--Header-->
                    <div class="modal-header" *ngIf="orderStatus=='3'" style="background-color: red">
                        <h4 class="modal-title" id="myModalLabel">Order Details</h4>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <div class="modal-header" *ngIf="orderStatus!='3'">
                        <h4 class="modal-title" id="myModalLabel">Order Details</h4>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <div class="row" style="margin-left:10px;">
                        <!-- &nbsp;&nbsp;&nbsp;&nbsp; -->
                        <button type="button" class="btn btn-outline-primary" data-toggle="modal" *ngIf="orderStatus=='6' && orderStatusPayment!='2'" data-target="#invoicegenrate" data-dismiss="modal">Generate Invoice</button>&nbsp;
                        <button type="button" class="btn btn-outline-primary" data-toggle="modal" *ngIf="orderStatus=='2' " data-target="#customer" data-dismiss="modal">Accept</button>&nbsp;
                        <button type="button" class="btn btn-outline-primary" *ngIf="orderStatus=='2' " data-dismiss="modal" (click)="updateOrderStatus(orderNumber,'return')">Send Back </button>    
                    </div>
                    <!--Body-->
<<<<<<< HEAD
                    <div class="modal-body">
                        <div class="row tab_model" *ngIf="orderStatusPayment!='2'&& pp?.orderHandler==local.name && orderStatus!='3'" style="width:60%;margin-left:2%;">
=======
                    <!-- <div class="modal-body">
                        <div class="row tab_model" *ngIf="orderStatusPayment!='2'" style="width:60%;margin-left:2%;">
>>>>>>> 4d013310c38ff3841bc475e75a598c381002edbe
                            <div class="col-sm-8">

                                <label>Update Delegator's Public Key</label>
                                <input type="text" name="Enter Comment" (keyup)="search()" id="userNameSearch" style="margin-bottom:5px;width:100%" placeholder="Enter Delegator's Name">
                                <input type="text" *ngIf="isDelegatorSelected" [(ngModel)]="newOwnerPublicKey">
                            </div> 
                            <div class="col-sm-4" style="padding-top:20px;">
<<<<<<< HEAD

                                <button class="button" (click)="transferOwnerShip()">Update
                                            Handler</button>

=======
                                <button class="button" (click)="transferOwnerShip(orderNumber,newOwnerPublicKey)">Update
                                    Handler</button>
>>>>>>> origin/development
                            </div>
                        </div> -->
                        <hr>
                        <div class="row">
                            <div class="col-sm-12 col-xl-6">
                             
                                <table class="table table-hover tab_model" style="width:100%;word-break: break-word;">

                                    <tbody>
                                        <tr *ngIf="pp?.orderNumber">
                                            <td>Order Number</td>
                                            <td>
                                                <p>{{pp?.orderNumber}}</p>
                                            </td>
                                        </tr>
                                        <tr *ngIf="pp?.PO_Number">

                                            <td>PO Number</td>
                                            <td>{{pp?.PO_Number}}</td>
                                        </tr>
                                        <tr *ngIf="pp?.PO_Date">
                                            <td>PO Date</td>
                                            <td>{{pp?.PO_Date}}</td>
                                        </tr>
                                        <tr *ngIf="pp?.orderAmount">
                                            <td>Order Amount</td>
                                            <td>{{pp?.orderAmount}}</td>
                                        </tr>
                                        <tr *ngIf="pp?.orderDate">
                                            <td>Order Date</td>
                                            <td>
                                                <p>{{pp?.orderDate}}</p>
                                            </td>
                                        </tr>

                                        <tr *ngIf="pp?.orderHandler">
                                            <td>Order Handler</td>
                                            <td>
                                                <p>{{pp?.orderHandler}}</p>
                                            </td>
                                        </tr>
                                        <tr *ngIf="pp?.salesServiceTaxAmount">
                                            <td>Sales Service TaxAmount</td>
                                            <td>
                                                <p>{{pp?.salesServiceTaxAmount}}</p>
                                            </td>
                                        </tr>
                                        <tr *ngIf="pp?.owner">
                                            <td>Owner</td>
                                            <td>
                                                <p>{{pp?.owner}}</p>
                                            </td>
                                        </tr>
                                        <tr *ngIf="pp?.vendor?.name">
                                            <td>Vendor Name</td>
                                            <td>
                                                <p>{{pp?.vendor?.name}}</p>
                                            </td>
                                        </tr>

                                    </tbody>
                                </table>
                                <table class="table table-hover tab_model" *ngIf="pp?.goodsService.length" style="width:100%;word-break: break-word;">
                                    <tr>
                                        <td>Goods</td>
                                        <td>
                                            <table>
                                                <tr style="font-weight: 300;">
                                                    <td>Name</td>
                                                    <td>Quantity</td>
                                                    <td>Rate</td>
                                                    <td>Discount</td>
                                                </tr>
                                                <tr *ngFor="let g of pp?.goodsService">
                                                    <td>{{g.name}}</td>
                                                    <td>{{g.quantity}}</td>
                                                    <td>{{g.rate}}</td>
                                                    <td>{{g.discount}}</td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                </table>

                            </div>
                            <div class="col-sm-6 col-xl-6">

                                <div *ngIf="pp?.orderStatus?.comment || pp?.orderStatus?.employeeID" class="row tab_model" style="margin-left:auto;margin-right: auto;">
                                    <div class="col-lg-3">
                                        <p>Order Status</p>
                                    </div>
                                    <div class="col-lg-9">
                                        <div *ngIf="pp?.orderStatus?.comment" class="row">
                                            <div class="col-lg-4">
                                                <p>Comment:</p>
                                            </div>
                                            <div class="col-lg-8">
                                                <p>{{pp?.orderStatus?.comment}}</p>
                                            </div>
                                        </div>
                                        <hr>
                                        <div *ngIf="pp?.orderStatus?.employeeID" class="row">
                                            <div class="col-lg-4">
                                                <p>Employee Id :</p>
                                            </div>
                                            <div class="col-lg-8">
                                                <p>{{pp?.orderStatus?.employeeID}}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>


                                <div *ngIf="pp?.customer?.ID || pp?.customer?.addressBilling || pp?.customer?.addressShipping || pp?.customer?.employeeID" class="row tab_model" style="margin-left:auto;margin-right: auto;">
                                    <div class="col-lg-3">
                                        <p>Customer</p>
                                    </div>
                                    <div class="col-lg-9">
                                        <div class="row" *ngIf="pp?.customer?.ID">
                                            <div class="col-lg-4">
                                                <p>ID :</p>
                                            </div>
                                            <div class="col-lg-8">
                                                <p>{{pp?.customer?.ID}}</p>
                                            </div>
                                        </div>
                                        <hr>
                                        <div class="row" *ngIf="pp?.customer?.addressBilling">
                                            <div class="col-lg-4">
                                                <p>Address Billing :</p>
                                            </div>
                                            <div class="col-lg-8">
                                                <p>{{pp?.customer?.addressBilling}}</p>
                                            </div>
                                        </div>
                                        <hr>
                                        <div class="row" *ngIf="pp?.customer?.addressShipping">
                                            <div class="col-lg-4">
                                                <p>Address Shipping :</p>
                                            </div>
                                            <div class="col-lg-8">
                                                <p>{{pp?.customer?.addressShipping}}</p>
                                            </div>
                                        </div>
                                        <hr>
                                        <div class="row" *ngIf="pp?.customer?.employeeID">
                                            <div class="col-lg-4">
                                                <p>Employee ID :</p>
                                            </div>
                                            <div class="col-lg-8">
                                                <p>{{pp?.customer?.employeeID}}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row tab_model" *ngIf="pp?.orderPayment?.invoiceAmount || pp?.orderPayment?.invoiceDate ||pp?.orderPayment?.invoiceNumber|| pp?.orderPayment?.status?.comment||pp?.orderPayment?.status?.updater" style="margin-left:auto;margin-right: auto;">
                                    <div class="col-lg-3">
                                        <p>Order Payment</p>
                                    </div>
                                    <div class="col-lg-9">
                                        <div *ngIf="pp?.orderPayment?.invoiceAmount" class="row">
                                            <div class="col-lg-4">
                                                <p>Invoice Amount :</p>
                                            </div>
                                            <div class="col-lg-8">
                                                <p>{{pp?.orderPayment?.invoiceAmount}}</p>
                                            </div>
                                        </div>
                                        <hr>
                                        <div *ngIf=" pp?.orderPayment?.invoiceDate " class="row">
                                            <div class="col-lg-4">
                                                <p>Invoice Date :</p>
                                            </div>
                                            <div class="col-lg-8">
                                                <p>{{pp?.orderPayment?.invoiceDate}}</p>
                                            </div>
                                        </div>
                                        <hr>
                                        <div *ngIf="pp?.orderPayment?.invoiceNumber" class="row">
                                            <div class="col-lg-4">
                                                <p>Invoice Number :</p>
                                            </div>
                                            <div class="col-lg-8">
                                                <p>{{pp?.orderPayment?.invoiceNumber}}</p>
                                            </div>
                                        </div>
                                        <hr>
                                        <div *ngIf="pp?.orderPayment?.status?.comment" class="row">
                                            <div class="col-lg-4">
                                                <p>Status Comment :</p>
                                            </div>
                                            <div class="col-lg-8">
                                                <p>{{pp?.orderPayment?.status?.comment}}</p>
                                            </div>
                                        </div>
                                        <hr>
                                        <div *ngIf="pp?.orderPayment?.status?.updater" class="row">
                                            <div class="col-lg-4">
                                                <p>Status updater :</p>
                                            </div>
                                            <div class="col-lg-8">
                                                <p>{{pp?.orderPayment?.status?.updater}}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">

                    </div>
                </div>
            </div>
        </div>


        <!-- Modal -->
        <!-- Modal: modalCart -->
        <div class="modal fade" id="customer" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <!--Header-->
                    <div class="modal-header">
                        <h4 class="modal-title" id="myModalLabel">Accept Order</h4>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <!--Body-->
                    <div class="modal-body">

                        <table class="table table-hover">

                            <tbody>

                                <tr>

                                    <td>Comment</td>
                                    <td><input type="text" name="Enter Comment" [(ngModel)]="statusComment"></td>
                                    <td><a><i class="fas fa-times"></i></a></td>
                                </tr>
                                <tr>
                                    <td>Sales Service TaxAmount</td>
                                    <td><input type="text" name="Enter Employee Name" [(ngModel)]="salesServiceTaxAmountUpdate"></td>
                                    <td><a><i class="fas fa-times"></i></a></td>
                                </tr>
                                <tr>

                                    <td colspan="2">
                                        <table class="table table-hover ">
                                            <tr style="font-weight: 300;">
                                                <td>Name</td>
                                                <td>Discount</td>
                                            </tr>
                                            <tr *ngFor="let g of pp?.goodsService;let i=index">
                                                <td>{{g.name}}</td>
                                                <td><input type="text" value="{{g.discount}}" placeholder="Input Discount" (keyup.enter)=" getquantity($event,i)" (blur)=" getquantity($event,i)" /></td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                    </div>
                    <!--Footer-->
                    <div class="modal-footer">
                        <button type="button" class="btn btn-outline-primary" data-dismiss="modal">Close</button>
                        <button class="btn btn-primary" (click)="updateOrderStatus($event,orderNumber,'accept') " data-dismiss="modal">Save</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="customer11" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <!--Header-->
                    <div class="modal-header">
                        <h4 class="modal-title" id="myModalLabel">Accept Order</h4>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <!--Body-->
                    <div class="modal-body">
                        <table class="table table-hover">
                            <tbody>
                                <tr>
                                    <td>Comment</td>
                                    <td><input type="text" name="Enter Comment" [(ngModel)]="statusComment1"></td>
                                    <td><a><i class="fas fa-times"></i></a></td>
                                </tr>
                                <tr>
                                    <td>Sales Service TaxAmount</td>
                                    <td><input type="text" name="Enter Employee Name" [(ngModel)]="salesServiceTaxAmountUpdate1"></td>
                                    <td><a><i class="fas fa-times"></i></a></td>
                                </tr>
                                <tr>
                                    <td>Discount</td>
                                    <td><input type="text" name="Goods&Services Discount" [(ngModel)]="goodsServicesDiscount1"></td>
                                    <td><a><i class="fas fa-times"></i></a></td>
                                </tr>
                            </tbody>
                        </table>

                    </div>
                    <!--Footer-->
                    <div class="modal-footer">
                        <button type="button" class="btn btn-outline-primary" data-dismiss="modal">Close</button>
                        <button class="btn btn-primary" data-dismiss="modal" (click)="updateMultipleOrderStatus('accept') "> Save</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Modal -->
        <div class="modal fade" id="invoicegenrate">
            <div class="modal-dialog modal-dialog-centered" role="document" style="z-index:11;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLongTitle">Invoice Details</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <form [formGroup]="invoiceData">
                            <div class="form-group">
                                <label for="invoiceNumber1">Invoice Number</label>
                                <input type="email" formControlName="invoiceNumber" class="form-control" id="invoiceNumber1" aria-describedby="nameHelp" placeholder="Enter Invoice Number">
                                <!-- <small id="nameHelp" class="form-text text-muted">Name must be under 16 char.</small> -->
                            </div>
                            <div class="form-group">
                                <label for="invoiceDate1">Invoice Date</label>
                                <input type="date" formControlName="invoiceDate" class="form-control" id="invoiceDate1" aria-describedby="ethHelp" placeholder="Enter Invoice Date">
                                <!-- <small id="ethHelp" class="form-text text-muted">Please provide user valid public key.</small> -->
                            </div>
                            <div class="form-group">
                                <label for="invoiceAmount1">Invoice Amount</label>
                                <input type="Number" formControlName="invoiceAmount" class="form-control" id="invoiceAmount1" placeholder="Enter Invoice Amount" value="{{orderAmount}}">
                            </div>
                            <div class="form-group">
                                <label for="comment1">Comment</label>
                                <input type="text" formControlName="comment" class="form-control" id="comment1" placeholder="Enter comment for invoice">
                            </div>

                            <!-- <button type="submit" [disabled]="!registerUser.valid" class="btn btn-primary">Submit</button> -->
                        </form>
                    </div>
                    <div class="modal-footer">

                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="invoiceDataUpload()" [disabled]="!invoiceData.valid">Save Changes</button>
                    </div>
                </div>
            </div>
        </div>